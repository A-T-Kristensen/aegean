<?xml version="1.0" encoding="utf-8"?>

<aegean version="0.1">
    <description>Test platform</description>

	<platform width="3" height="2">

		<!-- <topology type="bitorus"/"mesh"/"custom" routerDepth="k" linkDepth="k"> -->
		<topology topoType="custom" routerDepth="1" linkDepth="0">
			<link source="(0,0)" sink="(0,1)" linkDepth="0" />
			<link source="(0,0)" sink="(1,0)" linkDepth="0" />
			<link source="(0,1)" sink="(0,0)" linkDepth="0" />
			<link source="(0,1)" sink="(1,1)" linkDepth="0" />
			<link source="(1,0)" sink="(0,0)" linkDepth="0" />
			<link source="(1,0)" sink="(1,1)" linkDepth="0" />
			<link source="(1,0)" sink="(2,0)" linkDepth="0" />
			<link source="(1,1)" sink="(0,1)" linkDepth="0" />
			<link source="(1,1)" sink="(1,0)" linkDepth="0" />
			<link source="(1,1)" sink="(2,1)" linkDepth="0" />
			<link source="(2,0)" sink="(1,0)" linkDepth="0" />
			<link source="(2,0)" sink="(2,1)" linkDepth="0" />
			<link source="(2,1)" sink="(2,0)" linkDepth="0" />
			<link source="(2,1)" sink="(1,1)" linkDepth="0" />
		</topology>

		<nodes>
			<node id="pat0" loc="(0,0)" IPTypeRef="patmosD" />
			<node id="pat1" loc="(1,0)" IPTypeRef="patmosD" />
			<node id="pat2" loc="(2,0)" IPTypeRef="patmosS" />
			<node id="pat3" loc="(0,1)" IPTypeRef="patmosS" />
			<node id="pat4" loc="(1,1)" IPTypeRef="patmosS" />
			<node id="pat5" loc="(2,1)" IPTypeRef="patmosS" />
		</nodes>

		<memory id="ram0" IODevTypeRef="Ssram" size="2M" />

		<IPCores>
			<IPCore IPType="patmosD">
				<patmos>
					<description>Dual issue slot patmos</description>

					<frequency Hz="80000000" />
					<pipeline dual="true" />
					<bootrom app="bootable-mandelbrot"/>
					<MCache size="4k" blocks="16" repl="" />
					<DCache size="2k" assoc="1" repl="" />
					<ISPM size="8k" />
					<DSPM size="2k" />
					<BootSPM size="2k" />

					<ExtMem size="2M" />

					<!-- currently unused -->
					<SCache size="0" />
				</patmos>
			</IPCore>
			<IPCore IPType="patmosS">
				<patmos>
					<description>Single issue slot patmos</description>

					<frequency Hz="80000000" />
					<pipeline dual="false" />
					<bootrom app="bootable-mandelbrot"/>
					<MCache size="4k" blocks="16" repl="" />
					<DCache size="2k" assoc="1" repl="" />
					<ISPM size="8k" />
					<DSPM size="2k" />
					<BootSPM size="2k" />

					<ExtMem size="2M" />

					<IOs>
					  <IO IODevTypeRef="UART" offset="8" />
					  <IO IODevTypeRef="Leds" offset="9" />
					</IOs>

					<!-- currently unused -->
					<SCache size="0" />

				</patmos>
			</IPCore>
		</IPCores>

		<IODevs>
		  <IODev IODevType="UART" entity="UART" iface="OcpCore">
			<params>
			  <param name="baud" value="115200" />
			</params>
			<ports>
			  <inport name="rxd" />
			  <outport name="txd" />
			</ports>
		  </IODev>
		  <IODev IODevType="Leds" entity="Leds" iface="OcpCore">
			<ports>
			  <outport name="led" width="9" />
			</ports>
		  </IODev>
		  <IODev IODevType="Ssram" entity="SsramBurstRW" iface="OcpBurst">
			<ports>
			  <outport name="addr" width="19" />
			  <outport name="dout" width="32" />
			  <inport  name="din" width="32" />
			  <outport name="dout_ena" />
			  <outport name="noe" />
			  <outport name="nbwe" />
			  <outport name="nbw" width="4" />
			  <outport name="ngw" />
			  <outport name="nce1" />
			  <outport name="ce2" />
			  <outport name="nce3" />
			  <outport name="nadsp" />
			  <outport name="adv" />
			</ports>
		  </IODev>
		</IODevs>

		<IOPorts>
		  <IOPort name="Ssram32">
			<out node="ram0" name="addr" width="19" pin="A27,A29,C37" />
			<inout node="ram0" outname="dout" inname="din" width="32" enaname="dout_ena"
				   pin="A27,A29,C37" />
		  </IOPort>
		  <IOPort name="UartPins">
			<out node="pat0" name="rxd" pin="B52" />
		  </IOPort>
		</IOPorts>

	</platform>

	<application>

		<entries>
			<entry idRef="pat0" entity="main" parameters="0 1" srcFile="file:///test2.c"/>
			<entry idRef="pat1" entity="main" parameters="0 1" srcFile="file:///test2.c"/>
			<entry idRef="pat2" entity="main" parameters="0 1" srcFile="file:///test2.c"/>
			<entry idRef="pat3" entity="main" parameters="0 1" srcFile="file:///test2.c"/>
		</entries>

		<memMap>
			<mem start="0xfff000" end="0xffff00" cached="false" >Description of the given memory area.</mem>
		</memMap>

		<!-- <communication type="all2all"/"custom" phits="s"> -->
		<communication comType="all2all" phits="1">
			<channel from="(0,0)" to="(0,1)" bandwidth="1" phits="1"/>
			<channel from="(0,0)" to="(1,0)" bandwidth="1" phits="1"/>
			<channel from="(0,0)" to="(1,1)" bandwidth="1" phits="1"/>
			<channel from="(0,0)" to="(2,0)" bandwidth="1" phits="1"/>
			<channel from="(0,0)" to="(2,1)" bandwidth="1" phits="1"/>
			<channel from="(0,1)" to="(0,0)" bandwidth="1" phits="1"/>
			<channel from="(0,1)" to="(1,0)" bandwidth="1" phits="1"/>
			<channel from="(0,1)" to="(1,1)" bandwidth="1" phits="1"/>
			<channel from="(0,1)" to="(2,0)" bandwidth="1" phits="1"/>
			<channel from="(0,1)" to="(2,1)" bandwidth="1" phits="1"/>
			<channel from="(1,0)" to="(0,0)" bandwidth="1" phits="1"/>
			<channel from="(1,0)" to="(0,1)" bandwidth="1" phits="1"/>
			<channel from="(1,0)" to="(1,1)" bandwidth="1" phits="1"/>
			<channel from="(1,0)" to="(2,0)" bandwidth="1" phits="1"/>
			<channel from="(1,0)" to="(2,1)" bandwidth="1" phits="1"/>
			<channel from="(1,1)" to="(0,0)" bandwidth="1" phits="1"/>
			<channel from="(1,1)" to="(0,1)" bandwidth="1" phits="1"/>
			<channel from="(1,1)" to="(1,0)" bandwidth="1" phits="1"/>
			<channel from="(0,1)" to="(2,0)" bandwidth="1" phits="1"/>
			<channel from="(0,1)" to="(2,1)" bandwidth="1" phits="1"/>
		</communication>
	</application>

</aegean>
